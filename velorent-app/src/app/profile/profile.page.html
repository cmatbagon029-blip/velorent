<ion-header>
  <ion-toolbar>
    <ion-title>Profile & Settings</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content id="main-content" class="ion-padding">
  <!-- User Profile Section -->
  <ion-card class="profile-card">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="person-circle" style="margin-right: 8px;"></ion-icon>
        Profile Information
      </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <!-- Logged in user information -->
      <div *ngIf="user" class="user-profile">
        <div class="profile-header">
          <ion-avatar class="profile-avatar">
            <img *ngIf="user.picture" [src]="user.picture" [alt]="user.name" class="profile-image">
            <ion-icon *ngIf="!user.picture" name="person-circle" class="avatar-icon"></ion-icon>
          </ion-avatar>
          <div class="profile-info">
            <h2 class="user-name">{{ user.name }}</h2>
            <p class="user-role">{{ user.role | titlecase }}</p>
          </div>
        </div>
        
        <div class="profile-details">
          <div class="profile-field">
            <ion-icon name="mail-outline" class="field-icon"></ion-icon>
            <div class="field-content">
              <span class="profile-label">Email Address</span>
              <span class="profile-value">{{ user.email }}</span>
            </div>
          </div>
          
          <div class="profile-field" *ngIf="user.provider">
            <ion-icon name="logo-google" *ngIf="user.provider === 'google'" class="field-icon"></ion-icon>
            <ion-icon name="logo-facebook" *ngIf="user.provider === 'facebook'" class="field-icon"></ion-icon>
            <div class="field-content">
              <span class="profile-label">Login Provider</span>
              <span class="profile-value">{{ user.provider | titlecase }}</span>
            </div>
          </div>
          
          <div class="profile-field" *ngIf="user.created_at">
            <ion-icon name="calendar-outline" class="field-icon"></ion-icon>
            <div class="field-content">
              <span class="profile-label">Member Since</span>
              <span class="profile-value">{{ user.created_at | date:'MMM dd, yyyy' }}</span>
            </div>
          </div>
          
          <div class="profile-field">
            <ion-icon name="key-outline" class="field-icon"></ion-icon>
            <div class="field-content">
              <span class="profile-label">User ID</span>
              <span class="profile-value">{{ user.id }}</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Not logged in message -->
      <div *ngIf="!user" class="no-user-message">
        <ion-icon name="person-circle-outline" class="no-user-icon"></ion-icon>
        <h3>No User Logged In</h3>
        <p>Please log in with Google or Facebook to view your profile information.</p>
        <ion-button expand="block" fill="outline" (click)="goToLogin()" style="margin-top: 16px;">
          <ion-icon name="log-in-outline" slot="start"></ion-icon>
          Go to Login
        </ion-button>
        
      </div>
    </ion-card-content>
  </ion-card>


  <!-- App Settings Section (Available to all users) -->
  <ion-card class="settings-card">
    <ion-card-header>
      <ion-card-title>App Settings</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item>
          <ion-icon name="notifications-outline" slot="start"></ion-icon>
          <ion-label>Push Notifications</ion-label>
          <ion-toggle [(ngModel)]="notifications" (ionChange)="toggleNotifications()"></ion-toggle>
        </ion-item>
        <ion-item>
          <ion-icon name="location-outline" slot="start"></ion-icon>
          <ion-label>Location Services</ion-label>
          <ion-toggle [(ngModel)]="locationServices" (ionChange)="toggleLocationServices()"></ion-toggle>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <!-- Legal & Support Section (Available to all users) -->
  <ion-card class="legal-card">
    <ion-card-header>
      <ion-card-title>Legal & Support</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item button (click)="openPrivacyPolicy()">
          <ion-icon name="shield-outline" slot="start"></ion-icon>
          <ion-label>Privacy Policy</ion-label>
        </ion-item>
        <ion-item button (click)="openTermsOfService()">
          <ion-icon name="document-text-outline" slot="start"></ion-icon>
          <ion-label>Terms of Service</ion-label>
        </ion-item>
        <ion-item button (click)="openHelp()">
          <ion-icon name="help-circle-outline" slot="start"></ion-icon>
          <ion-label>Help & Support</ion-label>
        </ion-item>
        <ion-item button (click)="openAbout()">
          <ion-icon name="information-circle-outline" slot="start"></ion-icon>
          <ion-label>About VeloRent</ion-label>
        </ion-item>
        <ion-item button (click)="openContact()">
          <ion-icon name="mail-outline" slot="start"></ion-icon>
          <ion-label>Contact Us</ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <!-- Account Management Section (Only for logged-in users) -->
  <ion-card class="account-card" *ngIf="user">
    <ion-card-header>
      <ion-card-title>Account Management</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item button (click)="openEditProfile()">
          <ion-icon name="create-outline" slot="start"></ion-icon>
          <ion-label>Edit Profile</ion-label>
        </ion-item>
        <ion-item button (click)="openChangePassword()">
          <ion-icon name="key-outline" slot="start"></ion-icon>
          <ion-label>Change Password</ion-label>
        </ion-item>
        <ion-item button (click)="openAccountSettings()">
          <ion-icon name="settings-outline" slot="start"></ion-icon>
          <ion-label>Account Settings</ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <!-- Logout Button (Only for logged-in users) -->
  <ion-button expand="block" color="danger" class="logout-btn" *ngIf="user" (click)="logout()">
    <ion-icon name="log-out-outline" slot="start"></ion-icon>
    Sign Out
  </ion-button>

  <!-- App Information -->
  <ion-card class="app-info-card">
    <ion-card-content>
      <div class="app-info">
        <ion-icon name="car-sport-outline" class="app-icon"></ion-icon>
        <h3>VeloRent</h3>
        <p>Version 1.0.0</p>
        <p>Vehicle Rental Management System</p>
        <p class="copyright">Â© 2025 VeloRent. All rights reserved.</p>
      </div>
    </ion-card-content>
  </ion-card>
</ion-content>

<!-- Bottom Navigation -->
<div class="bottom-nav">
  <div class="nav-container">
    <button class="nav-button" (click)="navigateToHome()">
      <ion-icon name="home" class="nav-icon"></ion-icon>
      <span class="nav-label">Home</span>
    </button>
    
    <button class="nav-button" (click)="navigateToMyRentals()">
      <ion-icon name="car-outline" class="nav-icon"></ion-icon>
      <span class="nav-label">My Rentals</span>
    </button>
    
    <button class="nav-button" (click)="navigateToRequests()">
      <ion-icon name="document-text-outline" class="nav-icon"></ion-icon>
      <span class="nav-label">Requests</span>
    </button>
    
    <button class="nav-button" (click)="navigateToNotifications()">
      <div class="notification-wrapper">
        <ion-icon name="notifications-outline" class="nav-icon"></ion-icon>
        <div *ngIf="unreadCount > 0" class="notification-badge">
          {{ unreadCount }}
        </div>
      </div>
      <span class="nav-label">Notifications ({{ unreadCount }})</span>
    </button>
    
    <button class="nav-button active" (click)="navigateToProfile()">
      <ion-icon name="person-outline" class="nav-icon"></ion-icon>
      <span class="nav-label">Profile</span>
    </button>
  </div>
</div>